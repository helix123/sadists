```{r setup,include=FALSE}
# set the knitr options ... for everyone!
# if you unset this, then vignette build bonks. oh, joy.
#opts_knit$set(progress=TRUE)
opts_knit$set(eval.after='fig.cap')
# for a package vignette, you do want to echo.
# opts_chunk$set(echo=FALSE,warning=FALSE,message=FALSE)
opts_chunk$set(warning=FALSE,message=FALSE)
#opts_chunk$set(results="asis")
opts_chunk$set(cache=TRUE,cache.path="cache/")

#opts_chunk$set(fig.path="github_extra/figure/",dev=c("pdf","cairo_ps"))
#opts_chunk$set(fig.path="github_extra/figure/",dev=c("png","pdf"))
opts_chunk$set(fig.path="github_extra/figure/",dev=c("png"))
opts_chunk$set(fig.width=5,fig.height=4,dpi=64)

# doing this means that png files are made of figures;
# the savings is small, and it looks like shit:
#opts_chunk$set(fig.path="figure/",dev=c("png","pdf","cairo_ps"))
#opts_chunk$set(fig.width=4,fig.height=4)
# for figures? this is sweave-specific?
#opts_knit$set(eps=TRUE)

# this would be for figures:
#opts_chunk$set(out.width='.8\\textwidth')
# for text wrapping:
options(width=64,digits=2)
opts_chunk$set(size="small")
opts_chunk$set(tidy=TRUE,tidy.opts=list(width.cutoff=50,keep.blank.line=TRUE))

#sadists.meta <- packageDescription('sadists')
require(sadists)
```

# sadists

[![Build Status](https://travis-ci.org/shabbychef/sadists.png)](https://travis-ci.org/shabbychef/sadists)

Some Additional Distributions apparently not available in R.

-- Steven E. Pav, shabbychef@gmail.com

## Installation

This package may be installed from CRAN; the latest version may be
found on [github](https://www.github.com/shabbychef/sadists "sadists")
via devtools, or installed via [drat](https://github.com/eddelbuettel/drat "drat"):

```{r install,eval=FALSE,echo=TRUE}
if (require(devtools)) {
	# latest greatest
	install_github('shabbychef/sadists')
}
# via drat:
if (require(drat)) {
	drat:::add('shabbychef')
	install.packages('sadists')
}
```

## Testing distributions

First let's create a function which will test 'dpqr' functions:

```{r dpqr,eval=TRUE,echo=TRUE}
require(ggplot2)
# from: http://www.cookbook-r.com/Graphs/Multiple_graphs_on_one_page_(ggplot2)/
# Multiple plot function
#
# ggplot objects can be passed in ..., or to plotlist (as a list of ggplot objects)
# - cols:   Number of columns in layout
# - layout: A matrix specifying the layout. If present, 'cols' is ignored.
#
# If the layout is something like matrix(c(1,2,3,3), nrow=2, byrow=TRUE),
# then plot 1 will go in the upper left, 2 will go in the upper right, and
# 3 will go all the way across the bottom.
#
multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
  require(grid)

  # Make a list from the ... arguments and plotlist
  plots <- c(list(...), plotlist)

  numPlots = length(plots)

  # If layout is NULL, then use 'cols' to determine layout
  if (is.null(layout)) {
    # Make the panel
    # ncol: Number of columns of plots
    # nrow: Number of rows needed, calculated from # of cols
    layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
                    ncol = cols, nrow = ceiling(numPlots/cols))
  }

 if (numPlots==1) {
    print(plots[[1]])

  } else {
    # Set up the page
    grid.newpage()
    pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))

    # Make each plot, in the correct location
    for (i in 1:numPlots) {
      # Get the i,j matrix positions of the regions that contain this subplot
      matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))

      print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
                                      layout.pos.col = matchidx$col))
    }
  }
}
testf <- function(dpqr,nobs=512,...) {
	rv <- dpqr$r(nobs,...)
	dv <- dpqr$d(rv,...)
	pv <- dpqr$p(rv,...)
	qv <- dpqr$q(ppoints(nobs),...)

	# http://stackoverflow.com/a/5688125/164611
	p1 <- qplot(rv, geom = 'blank') +   
		geom_line(aes(y = ..density.., colour = 'Empirical'), stat = 'density') +  
		stat_function(fun = function(x) { dpqr$d(x,...) }, aes(colour = 'Theoretical')) +                       
		geom_histogram(aes(y = ..density..), alpha = 0.4) +                        
		scale_colour_manual(name = 'Density', values = c('red', 'blue')) 

	p2 <- qplot(rv, stat='qq', dist=function(p) { dpqr$q(p,...) })

	multiplot(p1,p2)
}

require(sadists)
wts <- c(1,-3,4)
df <- c(100,20,10)
ncp <- c(5,3,1)
dpqr <- list(d=dsumchisq,p=psumchisq,q=qsumchisq,r=rsumchisq)
testf(list(d=dsumchisq,p=psumchisq,q=qsumchisq,r=rsumchisq),nobs=4096,wts,df,ncp)


```

## Doubly non-central t distribution

The [doubly non-central t distribution](https://en.wikipedia.org/wiki/Doubly_noncentral_t-distribution)
generalizes the t distribution to the case where the denominator chi-square is non-central.

```{r dnt,eval=TRUE,echo=TRUE}
require(sadists)
k <- 5
mu <- 1
theta <- 2
rvs <- rdnt(1000, k, mu, theta)
#pvs <- pdnt(rvs, k, mu, theta)
#qvs <- qdnt(pvs, k, mu, theta)
#plot(ecdf(pvs))

```

## Doubly non-central F distribution

The doubly non-central F distribution generalizes the F distribution to the case where the denominator
chi-square is non-central. It has not yet been implemented.

## Sum of (non-central) Chi-squares

The weighted sum of chi-squares is not a commonly seen random variable. However, its cumulants can be
easily computed, so its 'PDQ' functions can easily be computed. Moreover, its distribution and quantile
functions can be used in computation of those of the doubly non-central F.

```{r schisq,eval=TRUE,echo=TRUE}
require(sadists)
wts <- c(1,-3,4)
df <- c(100,20,10)
ncp <- c(5,3,1)
dpqr <- list(d=dsumchisq,p=psumchisq,q=qsumchisq,r=rsumchisq)
ph <- testf(list(d=dsumchisq,p=psumchisq,q=qsumchisq,r=rsumchisq),nobs=4096,wts,df,ncp)
print(ph)

```

## K-prime distribution

## Lambda prime distribution

## Upsilon distribution



# Basic Usage

